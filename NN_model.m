function [y1] = NN_model(x1)
%NN_MODEL neural network simulation function.
%
% Auto-generated by MATLAB, 02-Sep-2020 20:59:59.
% 
% [y1] = NN_model(x1) takes these arguments:
%   x = 28xQ matrix, input #1
% and returns:
%   y = 4xQ matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.824769756919744;-0.819976042969736;-1.70999023407952;-1.43998046815112;-1.0526900285858;-1.05003723258287;-4.06997238075402;-1.69996124148957;-1.14206277148681;-1.01999633777675;-2.20997085482274;-2.29994506668119;24.9333793653043;25.100093081339;24.9000366220974;-1.19998168889358;0.0142092895799671;0.0160004272591366;0;-7.50890102847084;80.0002136295175;80.0002136295175;80.0002136295175;-15.9998779259523;48.5002975555488;49.0004119999602;48.0001831111374;-36.9994659261463];
x1_step1.gain = [0.998119037853208;0.523566128146517;0.69443623945377;0.638990034198243;1.38152875796992;0.706718597517416;0.501260973401298;0.598813967496437;0.978409229338132;0.630919716107269;0.645169261436417;0.471709589163294;0.183839838415527;0.183487805439876;0.183488447623576;0.833346049573499;0.221939994879772;0.219035889270659;0.221951400615034;0.139074791653139;0.100001068158997;0.100001068158997;0.100001068158997;0.0869574448040891;0.0233918942735431;0.0235295258136906;0.023255863469856;0.0243906887073402];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.4748689836561770239;-1.2976039917346116059;-0.82711131807096105462;0.55719761121724864505;-0.24038864416231436882;0.18168559953270238538;0.46675608742691709896;-0.78653800470318746552;1.1575087098323197932;-1.5439015700489289173];
IW1_1 = [0.082005185264932348166 -0.46461895329687957767 0.25012329829791368763 0.44117260109196720919 0.096602647553636469824 0.41325712693686117438 0.3633021117538032807 -0.034964637752626530343 0.2804243290682741363 -0.070476243672693991704 0.047576440404576675336 0.23655063333951148463 0.088474920860900946318 0.42899186303743153115 -0.39317805991852683434 -0.1353592842486016079 -0.023980320469555341939 0.29596276416930616948 -0.39212494436567812972 -0.30315703036982383223 0.19613523444790337269 0.1657207395653938764 -0.15815595240953356226 -0.33668073959973382481 0.22109122663459082614 -0.31460423043174934321 0.32864941104587136467 -0.46766384795961762899;0.34239067692579616686 -0.17331664562582160816 0.16967011340313561951 -0.27728294170028533472 0.033767728406972924438 0.176489357937278879 0.13634499482055237318 0.10860481724597324804 0.37276019314665720383 -0.18931536985577698817 -0.32291388790106700935 0.4164445117093308335 -0.40643240583181722281 0.19280064499272300815 0.097379086295032779574 -0.066239920202535301774 -0.27519276379197221694 0.22497251028744047474 -0.36510717303329337513 -0.23025764390665379167 -0.4536077566458295296 0.44388899297087425211 0.027821024307943802156 0.061272731489996207221 0.18562646191304046916 -0.10638789514711589901 -0.44903406073251739272 -0.18763572809941400643;0.042040193684647619854 0.38309511069696972063 0.31504117205506548816 0.44248823461740655061 0.36469030148747227926 0.090452515060627944332 -0.1068729343054583697 -0.16394961589191131557 -0.041572804697069289104 0.44398440398004895835 0.3761008217039795154 0.45287836802575143214 -0.12270774857051518214 0.19729778997128080698 0.22363606353033502194 0.32780792541940179108 -0.41134356392862103657 -0.072503001404868192004 0.1085625965458656278 -0.20287244425069830833 0.16023066969758578693 -0.35346487590175584836 -0.17208046502016322021 0.06783014323333624862 0.17538758849061453216 0.49548686869451641357 -0.12656244932814006421 0.41224600887116452652;-0.14693109464066250736 -0.28200284388327329088 0.29675357000720459233 -0.34597095718112086393 0.32128389346995250841 -0.45188057750298932236 -0.24910712509977653295 0.12528222019366636042 -0.18164914186508601679 -0.17952236498580378954 -0.31704864083908790295 0.3659949125164781436 0.20543024305074561453 0.36769910288947715848 0.25763534212824978908 -0.41513466596078030246 0.0077083785857343769046 -0.11063698149194244047 -0.30561823083937905698 0.44049098423126503699 -0.27108068962319320505 -0.28782892159623457706 -0.14598930583153349461 -0.12234524684731055977 0.06488560326918649257 -0.32903567042977477364 0.16602025779493806423 0.42942798502258294757;0.34500436941728679363 -0.26403961193001690422 -0.12996516029935725745 0.40542111414731352159 -0.43115924995604187897 -0.070678760144028143775 0.23007262406694847789 0.082213733254268936412 0.01479941796343183999 0.35227281566761453613 -0.12325505466687010359 0.38604246926888502456 0.33908672677388929095 0.12683883187987299301 -0.50740804331663280635 -0.34409119696268808397 -0.37833807351537118713 0.48927793756281923176 -0.098775092743553394303 0.0052099904245743785397 -0.14881157223016330815 0.26400055622466983563 0.051147936609349561876 0.2374151196894714877 -0.12105822528974431729 -0.027027956057879866381 -0.35157029048029514451 0.14962800373702153656;0.26559490739754659794 0.069585341510673068277 -0.35643920297918280093 -0.15788939476328048284 0.1917243234366393656 0.23654953368137776604 -0.22612964958324077713 -0.41420116373209531213 -0.32594384051955876958 -0.30256811040754599818 0.32056719438535230537 -0.35903727320423767244 -0.2326494422677918561 -0.32124515206991932637 0.40561676768350563016 0.33303004782055373179 0.10788715194907237682 -0.19253880566842018762 0.1657877947935991747 0.41013426262263247279 -0.16669157126721129147 -0.078696692461259487583 -0.20512959289378771 0.073418276855404904224 -0.43624840964382755049 0.1781538879867251568 0.26935995139534457676 0.0342451667695171727;0.31151706251342592413 -0.13838135576848184516 0.16380745973945806671 0.36167466829700956055 0.011235345635951729526 0.34159448481088300342 -0.472001547594780968 -0.45487027418934367073 -0.46478667458911926413 0.35709276738911677196 -0.15689547225978414668 0.30083078752809633283 0.36069937830976284143 -0.26215090266087431869 -0.45845738579578410032 0.15424347284695716365 0.27071446698568590872 0.039661092100581350761 -0.14726304251542232659 -0.25249867309722556774 -0.28050687033270954585 -0.44482683650184373647 0.12331229919784120197 -0.28314149358723811334 0.36802589040689842603 -0.056480975293240663626 -0.011942497487808319614 0.16580644818197770585;-0.09588094746149510017 -0.06882532905616767227 0.35207567100507675129 -0.40778525044141544775 -0.42039053608451087962 -0.20113316821634152909 -0.17322762222499660245 0.073961895123308737943 -0.0211819824623444182 -0.21147861578540708138 0.028700718772901461645 -0.28680462250887295284 0.1830912023859463944 -0.40333633661105922075 0.042790087378259247797 -0.25881932114838407388 0.28314502663302992813 0.18029400576624432517 0.098594031722120556438 0.43082077246505895429 0.56076810589421555164 -0.032148586867811884682 0.17169955643080153651 0.51056342736151061334 0.12079908642170371358 0.11697729699839501394 0.16556035867013418894 0.39720958283331303518;0.35030968462776956862 0.013682008005546834536 0.19724983542226165456 0.29183082048199343594 0.23331634918311139337 0.29038457142772566844 0.33593211278367718364 -0.27961969691007798611 0.25310212171421969662 -0.22995874709609573361 0.083866691211621074986 0.37368403238505204511 -0.11595891165608197826 -0.41194841435246098982 0.32865815847685708739 0.27286101116570826708 0.05893519751346174701 0.14227679912405094553 -0.091613973695407913134 -0.20660546653361389069 0.36022950949607152049 -0.43808290434566499183 0.24612665493342752998 -0.1696136489377852441 0.46753566425973663856 0.49504186055804211275 0.22239579736691575396 -0.39349425073531035801;-0.064358027429310835088 -0.34246750086820110237 0.30373677679950245034 -0.17263395763653349713 -0.40554243280110624514 0.3821711211040690892 0.36755992741534065926 -0.066654509971094816345 -0.22246587654612703933 0.16891490003057069158 -0.14602477115949913378 -0.055039703654702683278 -0.34680957869237633018 0.24680200773590751928 0.073079704180923660273 0.21556491632945620762 0.32290640691445776644 0.41146244101822182504 -0.38809734964411746194 0.1955330777323766589 0.23124514243783966805 0.30980779149081222323 -0.4276528355382984703 0.10010217661048377569 -0.28527968585100688115 -0.30399923670859685387 -0.37836969943778120395 -0.0917881512205458161];

% Layer 2
b2 = [-0.29000029739591431932;-0.22230842816149409824;0.44453412162198296942;0.067959262891058913603];
LW2_1 = [-0.49800731731593711471 -0.012410266094188188157 -0.46409234837024160303 -0.62693400295929924138 0.65266861795407671298 -0.33374272447307407052 0.84655584953391804781 -0.52204879110630120209 -0.15080795192232945845 -0.094100792469279742614;0.21696865043753749136 -0.25533193757395589163 -0.56155624221284272668 0.0075275501381244580915 -0.88185212729189388359 0.84287363710106499859 -0.22062034671791599938 0.63579724693484251929 -0.98056173318114592252 -0.59235575170606513673;0.69324197591563330167 -0.32197977784009290669 -0.32042129276016290129 -0.55853403731889383899 -0.80605862749132950462 -0.062860893692436511926 0.50511707461719346224 -0.33223794817546570268 -0.14643113473615271269 -0.075194723784822933843;0.29758702870036346511 -0.58370151025352912111 0.83935944212442137324 -0.077423475699856234011 0.88477994811681470733 0.72837346289194737636 -0.23460089071003259464 0.66229647030051019829 0.36116697576458656194 0.59956728484276033964];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [2;2;2;2];
y1_step1.xoffset = [0;0;0;0];

% ===== SIMULATION ========

% Dimensions
Q = size(x1,2); % samples

% Input 1
xp1 = mapminmax_apply(x1,x1_step1);

% Layer 1
a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);

% Layer 2
a2 = repmat(b2,1,Q) + LW2_1*a1;

% Output 1
y1 = mapminmax_reverse(a2,y1_step1);
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
