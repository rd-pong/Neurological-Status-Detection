function [y1] = NN_model(x1)
%NN_MODEL neural network simulation function.
%
% Auto-generated by MATLAB, 02-Sep-2020 17:11:07.
% 
% [y1] = NN_model(x1) takes these arguments:
%   x = 28xQ matrix, input #1
% and returns:
%   y = 4xQ matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.824769756919744;-0.819976042969736;-1.70999023407952;-1.43998046815112;-1.0526900285858;-1.05003723258287;-4.06997238075402;-1.69996124148957;-1.14206277148681;-1.01999633777675;-2.20997085482274;-2.29994506668119;24.9333793653043;25.100093081339;24.9000366220974;-1.19998168889358;0.0142092895799671;0.0160004272591366;0;-7.50890102847084;80.0002136295175;80.0002136295175;80.0002136295175;-15.9998779259523;48.5002975555488;49.0004119999602;48.0001831111374;-36.9994659261463];
x1_step1.gain = [0.998119037853208;0.523566128146517;0.69443623945377;0.638990034198243;1.38152875796992;0.706718597517416;0.501260973401298;0.598813967496437;0.978409229338132;0.630919716107269;0.645169261436417;0.471709589163294;0.183839838415527;0.183487805439876;0.183488447623576;0.833346049573499;0.221939994879772;0.219035889270659;0.221951400615034;0.139074791653139;0.100001068158997;0.100001068158997;0.100001068158997;0.0869574448040891;0.0233918942735431;0.0235295258136906;0.023255863469856;0.0243906887073402];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.5974337087964272097;-1.1863863496443673995;0.67944043802667419829;-0.39191996575197907138;-0.21773669965110978297;-0.12488204495859150933;-0.4236961241407433687;0.94167579609613383251;1.211656688301851803;1.5670377591295479025];
IW1_1 = [0.3114587996479452614 -0.30150489310231964879 0.13145604010691508412 0.20616061798270909899 -0.020048248834872953172 -0.16311066218727435229 0.19473269740819929008 0.33471648180852903165 -0.12484158824515119435 -0.37318923332477554888 -0.34457135006035977121 -0.056325964068201062052 -0.39024828662393529211 -0.068107042497599259989 0.34815111033524148709 -0.076621115796681488197 0.33697855671849497039 -0.20218417592372514568 0.10648481731974063225 0.42066697444349454571 0.092551893243539892775 -0.34001917815689908231 -0.23545895511267792011 0.063596919829098416677 -0.37697539822811954036 0.48813501518599289319 -0.42223066160492989107 -0.37851688181493881036;0.30599868815363712171 0.38265337059281306908 -0.44547870583988136151 -0.41618914195882034113 -0.12556789422448788596 0.13794309105108537583 -0.21751884681934377519 -0.22171405713551775585 0.28434315680158722683 -0.42281469060444332175 0.26762012886269248568 -0.36916654001274706864 0.38793445772527646032 0.34161107423130110394 0.080718421353123154249 -0.40723554935762840135 -0.12970415288899600492 -0.16361891965594774212 -0.21194372130801875098 0.24927253534875265517 -0.10323670388909660101 -0.17364812832360668193 0.3897549692457505377 -0.2160834233152795214 -0.22029684387776043986 0.03617738759448376612 0.34289901290455859773 0.13868998997251533178;-0.49694396062249529544 0.50418325071561753692 0.28913536915689513895 -0.22349835130774273195 0.30268861498076404803 0.22818086234697257386 -0.10908884860094637814 0.33589097858025551702 0.19190012612908866063 0.13824787636298122018 -0.16326646101626324237 -0.30621477069516700453 -0.54346431896204672185 -0.34909221106796189948 -0.16704832197460259269 0.43514748333646846579 -0.060726213107055566909 0.56430336509924772237 0.48529789509766685374 -0.020069130570262053853 0.23959271323634492856 -0.13351220623679743715 -0.1702265920490908524 0.046689158913289230401 0.24300846291666294841 -0.066261483854403918636 0.37031448875454830993 0.010827578396988979045;0.32805325303806848192 -0.10459658395443874324 0.40205776112892632757 -0.43940141489795353502 0.22002218508830007071 -0.41256840987037901591 0.26990048245837394703 -0.2430617167188453831 -0.019659830526034843823 0.18134351054658529034 0.016905350619885250313 0.40814456907471330371 0.28616769498890315404 -0.20984371796884357386 0.032207592505232418567 0.42295214674589304282 -0.16207127816059105352 -0.53748604395885657414 -0.37003238809923949537 -0.056998503011280739206 0.091870295331945836526 -0.19742317233136874588 -0.24697069034156551859 0.24860428564798919826 -0.48161510678682689646 -0.28293765759815442395 0.25600839581792017574 0.25608250710385294102;-0.015965781685295769854 0.20453620583893292184 0.073276935471485143969 -0.34870162115109287759 -0.29103387130330382604 -0.34507811717161546161 0.32141470484702638899 0.38218369577964195205 0.39537304498406605768 0.40486695592532007115 -0.28158625760566929896 -0.30903021283457982049 0.26606297710197379658 -0.33342186488837893821 -0.10492995936172408444 -0.010326816162150104922 -0.34406498505180377334 -0.39398031257486992862 0.18559791619727528111 -0.048752636675532388943 -0.15360526414751907165 0.28564283939547763236 0.34288246111836073737 -0.26743982714402647627 0.33103657893318771954 -0.06468152840561131045 -0.40793614622990970187 0.19590187591092503294;-0.2756155815031852141 -0.29103660057708335973 0.2998486031182782674 0.28408576096604648553 -0.040676462591459391915 -0.027786892861308171154 0.43683594338602022011 -0.13867150448230117221 -0.093600871447947028847 -0.28830480076548375967 0.17381197034105266841 0.29530028103653394034 0.42004846370596249372 -0.2494826203123253483 -0.30359009727184521621 -0.0076398213164440009759 -0.20192397107800177936 -0.16899471550192335378 -0.15870537308504903407 -0.17380265864348029559 0.41635354130171042808 -0.26214902485754776329 0.45301298904500902909 -0.33221464105907250186 0.1187954384353323567 0.02137923137129286652 -0.30775322273189786859 0.36662449099560062704;-0.24801961608147485294 -0.11712200691478856507 0.30579993860160847863 0.22159939461802394267 -0.070273932842281131017 0.50290299219274869902 0.11672243816661742599 -0.35021320218820634063 0.20785005561654590345 -0.00034418147613699229086 -0.32482330559851257945 0.05154162592180437652 -0.50375894503054841067 0.40981131207003651529 -0.32318194582853954078 -0.19129223468272824049 0.38269390777319606256 0.042860132620989359331 -0.28489282581226527125 0.0124235949708764188 0.4922992132673456589 -0.26332433986888692523 -0.018891707277553005523 -0.20466017356674950922 0.043111190002697898083 0.26904559975522907012 -0.13935025155191829715 0.44689208095095583895;0.026408838704352875087 0.41669751349898392911 -0.11450284141898976753 -0.21189581376153038272 0.12611736574175250181 -0.24931217682051609597 -0.34401015779565796704 -0.28078109268876838556 0.21016701211142818639 -0.12284809332142802851 0.15020655393395801469 0.57586680863466921387 -0.13289896038175144644 0.071566999221339633319 -0.45033812463918299063 0.45087532137521030284 0.41893928109556705097 0.1624781677292106985 0.041079986359164460952 0.01623470250851714522 0.1140983753305192111 -0.31850104008762186725 -0.39019713355422341872 -0.16979233621166023305 0.097847227339226766629 -0.10866721979064189463 0.21063421548583088905 -0.20159790761304735573;0.35137874236289584617 0.21893813541497664232 0.089387474581003031893 0.4931859362537697189 0.21801282614288924888 0.063588923000419697584 -0.34791790302942504631 0.12588177976440403927 -0.20605178499563914229 -0.59254737248812083816 0.16558351566926945986 -0.44848697960560940379 -0.28425507130461930005 0.028899105986264578272 -0.36662707377609488058 -0.14350448581644367763 0.0048414990659411709026 0.081908247913588139166 0.22910369423732224181 0.34538813652445871094 0.14716259029056352747 -0.28025779306317821771 -0.2472538217745755551 -0.070138248304794245658 -0.27942658958706001471 -0.13879208962388719928 -0.38863825537465368498 0.21032818484140092252;0.48788762688580727955 0.44910584525324304117 -0.296434412816812487 -0.4660789458528780127 0.21829603551188789257 -0.31285949483414832173 -0.21328910521964511426 -0.026056811340577783892 0.094335171279471510819 -0.16433581398867999623 0.28097467744619430974 -0.053209622923377164483 0.33315215200356262937 -0.31841167129878328312 -0.22357254544401555796 -0.38586481506417003029 -0.38312433556205599539 0.0047931914526067286031 -0.36344738223979433656 0.29515379263733831916 0.11329854519911992938 -0.036343198651424962753 -0.064434936452705454668 0.026328361448102882703 -0.084864010089168939732 0.44104555028574793374 0.17543452167792786267 -0.30447606665710430507];

% Layer 2
b2 = [-0.63730465587219675694;-0.4494557992028044846;0.64921302758174204151;0.79159086693535618551];
LW2_1 = [-0.94855270574152239504 0.75359594204238411486 0.54860257577586235556 0.75630261097122652991 0.9583262947536509424 -0.79460269288184803838 0.025493959845313253487 0.38412708418968499746 0.91478981848660889664 -0.13511114358410983294;0.65611906459621271992 0.39368416981375820018 0.1883219205275923902 -1.0266638310188278549 0.3167559721550229912 0.21097916434096594673 -0.62091983687250384971 -0.59927159798665874391 0.1820078007906313633 0.43405993633559580847;0.013795621667885398995 0.22781137230196585319 -0.55391937190805440316 0.0027281070788586917267 -0.023495692181200927839 -0.79038418313426883621 0.64707113065732191348 0.17273022679301092142 0.48655250931443555507 -0.79884612688282086168;-0.18975136708410628161 0.5854479996168424627 -0.57942342169523397555 -0.51486687531040942201 0.091595508876690656663 -0.69235087785382432024 0.48077021988755858084 -0.044494179116090583348 -0.011160741913055683208 -0.54080995894473760099];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [2;2;2;2];
y1_step1.xoffset = [0;0;0;0];

% ===== SIMULATION ========

% Dimensions
Q = size(x1,2); % samples

% Input 1
xp1 = mapminmax_apply(x1,x1_step1);

% Layer 1
a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);

% Layer 2
a2 = repmat(b2,1,Q) + LW2_1*a1;

% Output 1
y1 = mapminmax_reverse(a2,y1_step1);
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
